<div class="main workspace">
   <div class="h-full">
      <div class="h-full">
         <div class="text-dark text-2xl font-semibold mb-4">Appointments</div>
         <div class="h-full">
            <div class="h-full pb-8">
               <ng-container *ngIf="!appointments.length">
                  <div class="flex h-full items-center -mt-8">
                     <div
                        class="max-w-[420px] mx-auto bg-gradient-dark-300 rounded-lg text-base font-light text-primary-100 text-opacity-80"
                     >
                        <div class="px-9 py-8 text-justify">
                           <span class="text-primary-100">
                           It looks like you haven't booked any appointments at the
                           moment.
                           </span>
                           Not to worry, our team of specialized doctors is here to assist you with your
                           healthcare
                           needs. Whether you're seeking expert advice, a routine check-up, or specialized treatment,
                           we're
                           dedicated to providing you with the highest quality care. Feel free to book an appointment
                           with
                           one of our specialists right here, right now. If you've just booked an appointment a few
                           minutes
                           ago, please allow some time for it to appear in your appointments list. Thank you for
                           choosing
                           us for your healthcare journey.
                           <div class="mt-3 flex justify-end">
                              <a [routerLink]="['../', 'doctors']" class="btn btn-blue btn-shadow">
                                 Book Appointment
                              </a>
                           </div>
                        </div>
                     </div>
                  </div>
               </ng-container>

               <ng-container *ngFor="let appoint of appointments;">
                  <div class="bg-primary-100 bg-opacity-90 rounded-lg shadow-xl p-6 mb-6 mt-20">
                     <div class="relative">
                        <div class="profile-img mb-2">
                           <div class="flex -mt-16 ps-0">
                              <div class="flex items-center flex-col gap-y-2">
                                 <div class="relative">
                                    <img
                                       [src]="appoint.doctor?.profilePicFilename"
                                       alt=""
                                       class="w-[140px] object-cover aspect-square rounded-full shadow-lg ring ring-dark"
                                    />
                                    <a
                                       [queryParams]="{ d: appoint.doctor?.id }"
                                       [routerLink]="['../', 'doctor']"
                                       target="_blank"
                                       class="opacity-0 absolute inset-0 rounded-full"
                                    ></a>
                                 </div>
                                 <a routerLink="/p/doctor" class="block text-dark font-semibold text-xl">
                                    {{ appoint.doctor?.name }}
                                 </a>
                              </div>
                           </div>
                        </div>
                        <div class="sm:absolute right-0 top-14 text-dark text-opacity-40 flex justify-end gap-x-3">
                           <ng-container *ngIf="appoint.patientReview !== ''">
                              <div>
                                 <app-rating-stars [rating]="appoint.rating"></app-rating-stars>
                              </div>
                           </ng-container>
                           <div>
                              Appointment Number: {{ appoint.id }}
                           </div>
                        </div>
                        <div>
                           Requested Date: {{ appoint.paymentTime | datetime }}
                        </div>
                        <div>
                           Meeting Time: {{ [appoint.timeFrom, appoint.timeTo] | appointmentDuration }}
                        </div>
                        <div>
                           Meeting Secret Code: {{ appoint.secretCode }}
                           <span
                              (click)="secretCodeDescriptionModal.open()"
                              data-te-ripple-color="light"
                              data-te-ripple-init
                              class="cursor-pointer text-xl ms-1"
                           >
                              <fa-icon [icon]="faCircleQuestion" class="pointer-events-none"></fa-icon>
                           </span>
                        </div>
                        <div>
                           Status:
                           <ng-container ngSwitch="{{ appoint.status }}">
                              <span *ngSwitchCase="'PAT_NOT_JOINED_REQ'" class="text-danger-600 text-opacity-100">
                                 The doctor submitted request about your absence! We will respond soon.
                              </span>
                              <span *ngSwitchCase="'PAT_NOT_JOINED_REJ'" class="text-danger-600 text-opacity-100">
                                 The appointment is pending. Please reschedule!
                              </span>
                              <span *ngSwitchCase="'PAT_NOT_JOINED'" class="text-danger-600 text-opacity-100">
                                 You missed the appointment! The appropriate refund has been initiated.
                              </span>
                              <span *ngSwitchCase="'DOC_CANCELLED'" class="text-danger-600 text-opacity-100">
                                 The doctor canceled the appointment! The complete refund has been initiated.
                              </span>
                              <span *ngSwitchCase="'PAT_CANCELLED'" class="text-danger-600 text-opacity-100">
                                 You canceled the appointment!
                              </span>
                              <span *ngSwitchCase="'DOC_REQUESTED_DELAY'" class="text-yellow-600 text-opacity-100">
                                 The doctor requested to delay the appointment! Please reschedule!
                              </span>
                              <span *ngSwitchCase="'DOC_NOT_JOINED'" class="text-danger-600 text-opacity-100">
                                 The doctor missed the appointment! The complete refund has been initiated.
                              </span>
                              <span *ngSwitchCase="'SLOT_CLASH'" class="text-danger-600 text-opacity-100">
                                 The appointment has time slot clashed with the other patient. Please reschedule!
                              </span>
                              <span *ngSwitchCase="'PENDING'" class="text-warning-600 text-opacity-100">
                                 The appointment is pending. Please be on time!
                              </span>
                              <span *ngSwitchCase="'COMPLETED'" class="text-success-600 text-opacity-100">
                                 The appointment has been completed!
                                 <ng-container *ngIf="!appoint.patientReview">
                                    Please post your reviews!
                                 </ng-container>
                              </span>
                           </ng-container>
                           <span
                              (click)="selectAppointment(appoint.id); appointmentStatusDescriptionModal.open()"
                              data-te-ripple-color="light"
                              data-te-ripple-init
                              class="cursor-pointer text-xl ms-1"
                           >
                              <fa-icon [icon]="faCircleQuestion" class="pointer-events-none"></fa-icon>
                           </span>
                        </div>
                        <div class="sm:absolute right-0 bottom-0">
                           <div
                              #cardCollapseOpenBtn
                              [ngClass]="{'shake-top': appoint.status === 'DOC_REQUESTED_DELAY' ||
                              appoint.status === 'DOC_NOT_JOINED' || appoint.status === 'SLOT_CLASH' ||
                              (appoint.status === 'COMPLETED' && appoint.patientReview === '') }"
                           >
                              <form-submit-button
                                 (click)="
                                    selectAppointment(appoint.id);
                                    loadAppointmentSlots(appoint.id);
                                    expandable.classList.add('!grid-rows-[1fr]');
                                    cardCollapseOpenBtn.classList.add('!hidden')
                                 "
                                 btnStyle="btn-blue btn-shadow"
                                 label="More Details"
                              ></form-submit-button>
                           </div>
                        </div>
                        <div #expandable class="grid grid-rows-[0fr] transition-all duration-700 ease-in-out">
                           <div class="overflow-hidden">
                              <div class="mt-2">
                                 <div class="">Your Symptoms Description:</div>
                                 <div data-te-input-wrapper-init class="relative mb-3">
                                    <textarea
                                       [rows]="6"
                                       placeholder="Your message"
                                       readonly
                                       rows="3"
                                       class="peer form-input---input"
                                    >{{ appoint.symptomDescription }}</textarea>
                                 </div>
                              </div>
                              <ng-container *ngIf="appoint.status === 'COMPLETED'">
                                 <div class="mt-3">
                                    <div class="">Doctor's Report</div>
                                    <div data-te-input-wrapper-init class="relative mb-3">
                                    <textarea
                                       [rows]="6"
                                       placeholder="Your message"
                                       readonly
                                       rows="3"
                                       class="peer form-input---input"
                                    >{{ appoint.doctorReport }}</textarea>
                                    </div>
                                 </div>
                              </ng-container>
                              <ng-container *ngIf="appoint.status === 'COMPLETED'">
                                 <div class="mt-3 mb-3">
                                    <div class="">Your Reviews</div>
                                    <ng-container [formGroup]="appoint.patientReviewForm.fg">
                                       <div data-te-input-wrapper-init class="relative">
                                          <textarea
                                             [readonly]="appoint.patientReview !== ''"
                                             [rows]="6"
                                             formControlName="review"
                                             placeholder="Your message"
                                             rows="3"
                                             class="peer form-input---input"
                                          >{{ appoint.patientReview }}</textarea>
                                          <div
                                             data-te-input-helper-ref
                                             class="absolute w-full text-sm text-neutral-500 peer-focus:text-primary dark:text-neutral-200 dark:peer-focus:text-primary"
                                          ></div>
                                       </div>
                                       <form-error-box
                                          [errors]="appoint.patientReviewForm.errors.review"
                                          controlName="review"
                                       ></form-error-box>
                                    </ng-container>
                                 </div>
                                 <div class="mb-3">
                                    <div>Review Rating</div>
                                    <div class="flex flex-col items-start">
                                       <ng-container [ngSwitch]="appoint.rating === 0">
                                          <ng-container *ngSwitchCase="true">
                                             <ng-container [formGroup]="appoint.patientReviewForm.fg">
                                                <app-rating-stars-interactive
                                                   (change)="appoint.patientReviewForm.updateRating($event)"
                                                ></app-rating-stars-interactive>
                                                <div class="text-nowrap">
                                                   <form-error-box
                                                      [errors]="appoint.patientReviewForm.errors.rating"
                                                      controlName="rating"
                                                   ></form-error-box>
                                                </div>
                                             </ng-container>
                                          </ng-container>
                                          <ng-container *ngSwitchCase="false">
                                             <app-rating-stars [rating]="appoint.rating"></app-rating-stars>
                                          </ng-container>
                                       </ng-container>
                                    </div>
                                 </div>
                              </ng-container>
                              <ng-container
                                 *ngIf="
                                    appoint.status === 'DOC_REQUESTED_DELAY' || appoint.status === 'DOC_NOT_JOINED' || appoint.status === 'SLOT_CLASH'
                                 "
                              >
                                 <div class="mb-3 mt-3">
                                    <div class="py-4 px-6 border border-current rounded-md">
                                       <ng-container [ngSwitch]="appoint.status">
                                          <ng-container *ngSwitchCase="'DOC_REQUESTED_DELAY'">
                                             <div
                                                class="font-semibold mb-2 text-warning-600 text-opacity-100"
                                             >
                                                Your Appointment has been delayed by {{ appoint.doctor?.name }}. Please
                                                reschedule your appointment!
                                                <div
                                                   class="font-normal text-dark text-opacity-75"
                                                >
                                                   But you can certainly cancel your appointment and the refund will be
                                                   done according to the
                                                   <a
                                                      routerLink="/terms-and-conditions"
                                                      target="_blank"
                                                      class="underline text-blue-600"
                                                   >
                                                      Term and Conditions
                                                   </a>
                                                   of the system!
                                                </div>
                                             </div>
                                          </ng-container>

                                          <ng-container *ngSwitchCase="'DOC_NOT_JOINED'">
                                             <div
                                                class="font-semibold mb-2 text-warning-600 text-opacity-100"
                                             >
                                                Sorry for inconsistency, but {{ appoint.doctor?.name }} could not join
                                                the meeting. Please reschedule your appointment!
                                                <div
                                                   class="font-normal text-dark text-opacity-75"
                                                >
                                                   But you can certainly cancel your appointment and the refund will
                                                   be done according to the
                                                   <a
                                                      routerLink="/terms-and-conditions"
                                                      target="_blank"
                                                      class="underline text-blue-600"
                                                   >Term and Conditions
                                                   </a>
                                                   of the system!
                                                </div>
                                             </div>
                                          </ng-container>

                                          <ng-container *ngSwitchCase="'SLOT_CLASH'">
                                             <div
                                                class="font-semibold mb-2 text-warning-600 text-opacity-100"
                                             >Sorry! Your appointment has time slot clashed with the other patient.
                                              Please
                                              reschedule your appointment!
                                                <div
                                                   class="font-normal text-dark text-opacity-75"
                                                >But you can certainly cancel your appointment and the refund will be
                                                 done
                                                 according to the
                                                   <a
                                                      routerLink="/terms-and-conditions"
                                                      target="_blank"
                                                      class="underline text-blue-600"
                                                   >Term and Conditions
                                                   </a>
                                                 of the system!
                                                </div>
                                             </div>
                                          </ng-container>
                                       </ng-container>

                                       <ng-container [ngSwitch]="appoint.slots.status">
                                          <ng-container *ngSwitchCase="'NOT_FOUND'">
                                             <div class="mt-3">
                                                Doctor not available for the appointment. Please try rescheduling the
                                                appointment later or cancel the appointment.
                                                <span
                                                   (click)="loadAppointmentSlots(appoint.id)"
                                                   class="underline underline-offset-2 text-blue-500 cursor-pointer"
                                                >
                                                   click to retry!
                                                </span>
                                             </div>
                                          </ng-container>

                                          <ng-container *ngSwitchCase="'ERROR'">
                                             <div class="mt-3">
                                                Network error occurred while loading available appointment slots. Please
                                                try again later.
                                                <span
                                                   (click)="loadAppointmentSlots(appoint.id)"
                                                   class="underline underline-offset-2 text-blue-500 cursor-pointer"
                                                >
                                                   click to retry!
                                                </span>
                                             </div>
                                          </ng-container>

                                          <ng-container *ngSwitchCase="'DOC_NOT_ACTIVE'">
                                             <div class="mt-3">
                                                Doctor is not active for the appointment. Please try rescheduling the
                                                appointment later or cancel the appointment.
                                                <span
                                                   (click)="loadAppointmentSlots(appoint.id)"
                                                   class="underline underline-offset-2 text-blue-500 cursor-pointer"
                                                >
                                                   click to retry!
                                                </span>
                                             </div>
                                          </ng-container>

                                          <ng-container *ngSwitchCase="'LOADING'">
                                             <div class="mt-3">
                                                Loading available appointment slots...
                                             </div>
                                          </ng-container>

                                          <ng-container *ngSwitchCase="'FOUND'">
                                             <div class="mt-4">Select Your Appointment Week</div>
                                             <div class="flex justify-start flex-wrap">
                                                <ng-container
                                                   *ngFor="let week of ['Current Week', 'Next Week',
                                                'Week After Next']; let weekIndex = index"
                                                >
                                                   <div class="mb-[0.125rem] mr-4 inline-block min-h-[1.5rem] pl-[1.5rem]">
                                                      <input
                                                         id="weekSelectorRadio{{ weekIndex }}"
                                                         (change)="selectSlotWeek(appoint.id, weekIndex)"
                                                         [checked]="weekIndex == 0"
                                                         name="weekSelectorRadio"
                                                         type="radio"
                                                         value="weekSelectorRadio{{ weekIndex }}"
                                                         class="relative float-left -ml-[1.5rem] block mt-0.5 h-5 w-5 appearance-none rounded-full border-2 border-solid border-neutral-300 before:pointer-events-none before:absolute before:h-4 before:w-4 before:scale-0 before:rounded-full before:bg-transparent before:opacity-0 before:shadow-[0px_0px_0px_13px_transparent] before:content-[''] after:absolute after:z-[1] after:block after:h-4 after:w-4 after:rounded-full after:content-[''] checked:border-primary checked:before:opacity-[0.16] checked:after:absolute checked:after:left-1/2 checked:after:top-1/2 checked:after:h-[0.625rem] checked:after:w-[0.625rem] checked:after:rounded-full checked:after:border-primary checked:after:bg-primary checked:after:content-[''] checked:after:[transform:translate(-50%,-50%)] hover:cursor-pointer hover:before:opacity-[0.04] hover:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:shadow-none focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] checked:focus:border-primary checked:focus:before:scale-100 checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s] dark:border-neutral-600 dark:checked:border-primary dark:checked:after:border-primary dark:checked:after:bg-primary dark:focus:before:shadow-[0px_0px_0px_13px_rgba(255,255,255,0.4)] dark:checked:focus:border-primary dark:checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca]"
                                                      />
                                                      <label
                                                         for="weekSelectorRadio{{ weekIndex }}"
                                                         class="mt-px -ms-2 ps-3 inline-block pl-[0.15rem] hover:cursor-pointer"
                                                      >{{ week }}
                                                      </label>
                                                   </div>
                                                </ng-container>
                                             </div>
                                             <div class="mt-3">Select Your Appointment Slot</div>
                                             <div class="flex flex-col justify-start flex-wrap mt-1">

                                                <div class="[&:has(_.slot-available)_.slot-not-available-msg]:hidden">

                                                   <ng-container
                                                      *ngFor="let daySlots of
                                                      appoint.slots.list[appoint.slots.selectedWeekIndex];
                                                      let day = index"
                                                   >
                                                      <ng-container *ngIf="daySlots.length !== 0">
                                                         <ng-container *ngIf="daySlots[0]">
                                                            <div>
                                                               {{
                                                                  daySlots[0].timeFrom.getDay() - 1 | weekdayShort
                                                               }}
                                                            </div>
                                                         </ng-container>
                                                         <ng-container *ngFor="let slot of daySlots; let i = index">
                                                            <div class="pb-1">
                                                               <!--                                              (change)="slots.selectSlot(day, i)" -->
                                                               <input
                                                                  id="slotSelectorRadio{{ i }}"
                                                                  (change)="selectSlot(appoint.id, day, i)"
                                                                  name="slotSelectorRadio"
                                                                  type="radio"
                                                                  value="{{ i }}"
                                                                  class="relative float-left block mt-0.5 h-5 w-5 appearance-none rounded-full border-2 border-solid border-neutral-300 before:pointer-events-none before:absolute before:h-4 before:w-4 before:scale-0 before:rounded-full before:bg-transparent before:opacity-0 before:shadow-[0px_0px_0px_13px_transparent] before:content-[''] after:absolute after:z-[1] after:block after:h-4 after:w-4 after:rounded-full after:content-[''] checked:border-primary checked:before:opacity-[0.16] checked:after:absolute checked:after:left-1/2 checked:after:top-1/2 checked:after:h-[0.625rem] checked:after:w-[0.625rem] checked:after:rounded-full checked:after:border-primary checked:after:bg-primary checked:after:content-[''] checked:after:[transform:translate(-50%,-50%)] hover:cursor-pointer hover:before:opacity-[0.04] hover:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:shadow-none focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:shadow-[0px_0px_0px_13px_rgba(0,0,0,0.6)] focus:before:transition-[box-shadow_0.2s,transform_0.2s] checked:focus:border-primary checked:focus:before:scale-100 checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca] checked:focus:before:transition-[box-shadow_0.2s,transform_0.2s] dark:border-neutral-600 dark:checked:border-primary dark:checked:after:border-primary dark:checked:after:bg-primary dark:focus:before:shadow-[0px_0px_0px_13px_rgba(255,255,255,0.4)] dark:checked:focus:border-primary dark:checked:focus:before:shadow-[0px_0px_0px_13px_#3b71ca]"
                                                               />
                                                               <label
                                                                  for="slotSelectorRadio{{ i }}"
                                                                  class="mt-px -ms-2 ps-5 inline-block pl-[0.15rem] hover:cursor-pointer slot-available"
                                                               >
                                                                  {{
                                                                     [slot.timeFrom, slot.timeTo] | appointmentDuration: true
                                                                  }}
                                                               </label>
                                                            </div>
                                                         </ng-container>
                                                      </ng-container>
                                                   </ng-container>

                                                   <div class="text-dark text-opacity-60 slot-not-available-msg">
                                                      No slots available
                                                   </div>

                                                   <ng-container>
                                                      <!--                                  <form-error-box -->
                                                      <!--                                     [errors]="bookAppointment.errors.timeForm" -->
                                                      <!--                                     controlName="timeForm" -->
                                                      <!--                                  ></form-error-box> -->
                                                   </ng-container>
                                                </div>

                                             </div>

                                          </ng-container>
                                       </ng-container>

                                    </div>
                                 </div>
                              </ng-container>
                              <div class="flex justify-end items-center gap-x-3 mb-3">
                                 <form-submit-button
                                    (click)="expandable.classList.remove('!grid-rows-[1fr]'); cardCollapseOpenBtn.classList.remove('!hidden')"
                                    btnStyle="btn-primary-100"
                                    label="Less Details"
                                 ></form-submit-button>
                                 <ng-container *ngIf="appoint.status === 'COMPLETED' && appoint.patientReview === ''">
                                    <div class="shake-top">
                                       <form-submit-button
                                          (click)="
                                             appoint.patientReviewForm.submit();
                                          "
                                          btnStyle="btn-blue btn-shadow"
                                          label="Submit Reviews"
                                       ></form-submit-button>
                                    </div>
                                 </ng-container>
                                 <ng-container
                                    *ngIf="
                                       appoint.status === 'DOC_REQUESTED_DELAY' || appoint.status === 'DOC_NOT_JOINED' || appoint.status === 'SLOT_CLASH'
                                    "
                                 >
                                    <div [ngClass]="{'shake-top': appoint.slots.status === 'FOUND'}">
                                       <form-submit-button
                                          (click)="
                                             selectAppointment(appoint.id);
                                             refreshSelectedSlot(appoint.id);
                                             openRescheduleAppointmentModalConditionally(appoint.id);
                                          "
                                          [disableOnStart]="true"
                                          [disabled]="appoint.slots.status !== 'FOUND' || rescheduleAppointmentForm.loading"
                                          [waiting]="rescheduleAppointmentForm.loading"
                                          btnStyle="btn-yellow btn-shadlow"
                                          label="Reschedule Appointment"
                                       ></form-submit-button>
                                    </div>
                                 </ng-container>
                                 <ng-container
                                    *ngIf="
                                       appoint.status === 'PENDING' || appoint.status === 'DOC_REQUESTED_DELAY' ||
                                       appoint.status === 'SLOT_CLASH' || appoint.status === 'DOC_NOT_JOINED'
                                    "
                                 >
                                    <form-submit-button
                                       (click)="cancelAppointmentConfirmationModal.open()"
                                       btnStyle="btn-red btn-shadlow"
                                       label="Cancel Appointment"
                                    ></form-submit-button>
                                 </ng-container>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </ng-container>
            </div>
         </div>
      </div>
   </div>
</div>

<app-modal #postReviewConfirmationModal>
   <div title>Confirm Review Submission</div>
   <div body>Are you sure you want to submit your reviews and rating?</div>
   <div bottom>
      <div class="flex justify-end gap-x-1">
         <button
            data-te-modal-dismiss
            data-te-ripple-color="light"
            data-te-ripple-init
            type="button"
            class="btn btn-primary-100"
         > Cancel
         </button>
         <button data-te-ripple-color="light" data-te-ripple-init type="button" class="btn btn-blue btn-shadow">
            Submit
         </button>
      </div>
   </div>
</app-modal>

<app-modal #cancelAppointmentConfirmationModal>
   <div title>Confirm Appointment Cancellation</div>
   <div body>Are you sure you want to cancel this appointment?</div>
   <div bottom>
      <div class="flex justify-end gap-x-1">
         <form-submit-button
            (click)="cancelAppointmentConfirmationModal.close()"
            btnStyle="btn-primary-100"
            label="Keep Appointment"
         ></form-submit-button>
         <form-submit-button
            (click)="cancelAppointmentForm.submit()"
            [disabled]="cancelAppointmentForm.waiting"
            [waiting]="cancelAppointmentForm.waiting"
            btnStyle="btn-red btn-shadow"
            label="Cancel Appointment"
         ></form-submit-button>
      </div>
   </div>
</app-modal>

<app-modal #rescheduleAppointmentConfirmationModal>
   <div title>Confirm Appointment Reschedule</div>
   <div body>
      Are you sure you want to reschedule this appointment to
      <span class="text-dark font-semibold"> {{
            [selectedSlot.timeFrom, selectedSlot.timeTo] | appointmentDuration
         }}
      </span>
      ?
   </div>
   <div bottom>
      <div class="flex justify-end gap-x-1">
         <form-submit-button
            (click)="rescheduleAppointmentConfirmationModal.close()"
            btnStyle="btn-primary-100"
            label="No"
         ></form-submit-button>
         <form-submit-button
            (click)="rescheduleAppointmentForm.submit(selectedAppointmentId)"
            [disabled]="rescheduleAppointmentForm.loading"
            [waiting]="rescheduleAppointmentForm.loading"
            btnStyle="btn-yellow btn-shadow"
            label="Reschedule"
         ></form-submit-button>
      </div>
   </div>
</app-modal>

<app-modal #secretCodeDescriptionModal>
   <div title>Purpose of Secret Code</div>
   <div body>
      <span class="text-dark font-semibold">
         This code is meant to be shared with your doctor, after the meeting is concluded.
      </span>
      Its primary purpose is to provide confirmation that our consultation took place as scheduled, ensuring accuracy
      and trust in our appointment record. It acts as an
      assurance that the meeting indeed occurred, ensuring transparency and credibility in our healthcare interaction.
      <div class="text-dark font-semibold text-base">
         Do not share this code until the appointment has concluded!
      </div>
      <span>
         Sharing the code before the appointment meeting, may impact the
         <a routerLink="/terms-and-conditions" target="_blank" class="underline">refund policy</a>
         .
      </span>
   </div>
   <div bottom>
      <div class="flex justify-end gap-x-1">
         <button
            data-te-modal-dismiss
            data-te-ripple-color="light"
            data-te-ripple-init
            type="button"
            class="btn btn-blue btn-shadow"
         > OK, I understand.
         </button>
      </div>
   </div>
</app-modal>

<app-modal #appointmentStatusDescriptionModal>
   <div title>Appointment Status</div>
   <div body>
      <div class="[&_br]:h-5">
         <ng-container *ngIf="appointments.length > 0 && selectedAppointmentId !== -1">
            <ng-container [ngSwitch]="appointments[selectedAppointmentIndex].status">
               <ng-container *ngSwitchCase="'PAT_NOT_JOINED_REQ'">
                  When a doctor submits a request regarding your absence, it typically indicates that you were expected
                  to
                  attend an appointment or meeting but were not present. This could be due to various reasons such as
                  scheduling conflicts, unexpected emergencies, or other personal obligations. Upon receiving such a
                  request, the healthcare provider or relevant authority will typically review the circumstances
                  surrounding your absence and take appropriate action, which may include rescheduling the appointment,
                  providing further instructions, or addressing any concerns raised. It's important to communicate
                  promptly
                  with the healthcare provider or organization to ensure that any necessary follow-up steps are taken
                  and
                  that your healthcare needs are adequately addressed.
               </ng-container>
               <ng-container *ngSwitchCase="'PAT_NOT_JOINED_REJ'">
                  When an appointment status is marked as pending, it indicates that the scheduling process or
                  confirmation
                  of the appointment is still in progress. This could occur for various reasons, such as awaiting
                  confirmation from either party involved, unresolved scheduling conflicts, or administrative processing
                  delays. In such cases, it's advisable to take proactive steps to reschedule the appointment to ensure
                  timely and effective healthcare delivery. Initiating communication with the relevant healthcare
                  provider
                  or administrative staff to address any outstanding issues and confirm a new appointment time can help
                  expedite the process and ensure that your healthcare needs are met promptly.
               </ng-container>
               <ng-container *ngSwitchCase="'PAT_NOT_JOINED'">
                  You missed the appointment! The appropriate refund has been initiated.
                  <span class="text-dark font-semibold">
                     Please note that in such cases, no refunds will be issued, and rescheduling this appointment isn't
                     possible.
                     To book a new appointment, kindly initiate the process once again.
                  </span>
                  We apologize for any inconvenience and encourage scheduling a new appointment at your convenience to
                  avail of our services.
                  For more information, please read our
                  <a routerLink="/terms-and-conditions" target="_blank" class="underline">refund policy</a>
                  .
               </ng-container>
               <ng-container *ngSwitchCase="'DOC_CANCELLED'">
                  When a doctor cancels an appointment, it means that the scheduled meeting or consultation will not
                  take
                  place as planned. This cancellation could occur for various reasons, such as unexpected emergencies,
                  scheduling conflicts, or unforeseen circumstances on the doctor's end. In such cases, it's important
                  to
                  inform the patient promptly and provide appropriate support to address any inconvenience caused.
                  <br>
                  Upon cancellation, the healthcare provider typically initiates a complete refund of any fees or
                  charges
                  associated with the appointment. This ensures that the patient is not financially disadvantaged due to
                  the cancellation and helps maintain trust and satisfaction with the healthcare service provider.
                  <br>
                  Patients should be informed of the cancellation as soon as possible and provided with clear
                  instructions
                  on any necessary follow-up steps, such as rescheduling the appointment or seeking alternative
                  healthcare
                  options if needed. Effective communication and support during the cancellation process are essential
                  to
                  maintaining positive patient-provider relationships and ensuring a smooth experience for all parties
                  involved.
               </ng-container>
               <ng-container *ngSwitchCase="'PAT_CANCELLED'">
                  When a patient cancels an appointment, it means that the originally scheduled meeting or consultation
                  will
                  not take place as planned. This cancellation could occur for various reasons, such as unexpected
                  emergencies, scheduling conflicts, or changes in healthcare needs. In such cases, it's important to
                  inform
                  the healthcare provider promptly and take appropriate steps to address any inconvenience caused.
                  <br>
                  Upon cancellation, the patient may be subject to a cancellation fee or penalty, depending on the
                  healthcare
                  provider's policies and terms of service. Patients should review the terms and conditions of the
                  healthcare
                  provider to understand the cancellation policy and any associated fees or charges.
                  <br>
                  Patients should communicate with the healthcare provider's office or administrative staff to confirm
                  the
                  cancellation and inquire about any necessary follow-up steps, such as rescheduling the appointment or
                  seeking alternative healthcare options if needed. Clear communication and cooperation between the
                  patient
                  and healthcare provider are key to facilitating a smooth cancellation process and ensuring a positive
                  healthcare experience for all parties involved.
               </ng-container>
               <ng-container *ngSwitchCase="'DOC_REQUESTED_DELAY'">
                  When a doctor requests to delay an appointment, it means that the originally scheduled meeting or
                  consultation needs to be postponed to a later time or date. This request could arise due to various
                  reasons, such as unexpected emergencies, scheduling conflicts, or the need for additional preparation
                  or
                  resources.
                  <br>
                  In response to this request, it is important for the patient to take proactive steps to reschedule the
                  appointment. Initiating communication with the healthcare provider's office or administrative staff is
                  advisable to coordinate a new appointment time that accommodates both parties' schedules.
                  <br>
                  Rescheduling the appointment promptly ensures that the healthcare needs of the patient are addressed
                  in a
                  timely manner and minimizes any inconvenience caused by the delay. Clear communication and cooperation
                  between the patient and healthcare provider are key to facilitating a smooth rescheduling process and
                  ensuring continuity of care.
               </ng-container>
               <ng-container *ngSwitchCase="'DOC_NOT_JOINED'">
                  When the doctor misses an appointment, it means that they were unable to attend the scheduled meeting
                  or
                  consultation. This could occur due to various reasons, such as unexpected emergencies, professional
                  obligations, or administrative errors.
                  <br>
                  In such cases, it's essential for the healthcare provider to promptly inform the patient about the
                  missed
                  appointment and take appropriate steps to address any inconvenience caused. This typically includes
                  initiating a complete refund of any fees or charges associated with the appointment to ensure that the
                  patient is not financially disadvantaged due to the doctor's absence.
                  <br>
                  Clear communication with the patient is crucial during this process to explain the circumstances of
                  the
                  missed appointment and reassure them that their healthcare needs will be addressed promptly.
                  Additionally, the healthcare provider should offer to reschedule the appointment at the patient's
                  convenience to ensure continuity of care and maintain trust and satisfaction with the healthcare
                  service
                  provider.
               </ng-container>
               <ng-container *ngSwitchCase="'SLOT_CLASH'">
                  When an appointment encounters a time slot clash with another patient, it indicates that there is a
                  scheduling conflict that prevents the appointment from proceeding as originally planned. This clash
                  could
                  occur due to overlapping appointments, unforeseen delays, or administrative errors in scheduling.
                  <br>
                  In such cases, it is important to inform the patient promptly about the scheduling conflict and advise
                  them to reschedule the appointment to a mutually convenient time. This ensures that both patients
                  receive
                  the necessary attention and care without compromising the quality of service.
                  <br>
                  Initiating communication with the affected patient to coordinate a new appointment time is essential
                  to
                  minimize any inconvenience caused by the scheduling clash. Clear communication and flexibility in
                  accommodating the patient's schedule help ensure a smooth rescheduling process and maintain positive
                  patient-provider relationships.
               </ng-container>
               <ng-container *ngSwitchCase="'PENDING'">
                  When an appointment status is labeled as pending, it signifies that the scheduling process or
                  confirmation of the appointment is still ongoing. This could be due to various reasons, such as
                  awaiting
                  confirmation from either party involved, unresolved scheduling conflicts, or administrative processing
                  delays.
                  <br>
                  In such instances, it is crucial for the patient to be punctual and arrive on time for the scheduled
                  appointment. Being prompt helps to facilitate the smooth execution of the appointment process and
                  ensures
                  that healthcare resources are utilized efficiently.
                  <br>
                  Patients should adhere to the scheduled appointment time and arrive at the designated location
                  promptly
                  to avoid any further delays or complications. Additionally, staying in communication with the
                  healthcare
                  provider's office or administrative staff can help clarify any uncertainties regarding the appointment
                  and ensure that it proceeds smoothly.
                  <br>
                  By being on time and prepared for the appointment, patients can contribute to a positive healthcare
                  experience for themselves and others involved in the process.
               </ng-container>
               <ng-container *ngSwitchCase="'COMPLETED'">
                  When an appointment status is updated to "completed," it indicates that the scheduled meeting or
                  consultation has successfully concluded. This means that the healthcare provider and patient have met
                  as
                  planned, and any necessary examinations, treatments, or discussions have taken place.
                  <br>
                  For the patient, this status signifies that the intended purpose of the appointment has been
                  fulfilled,
                  and they may have received the necessary care, advice, or treatment from the healthcare provider. It
                  may
                  also indicate that any follow-up instructions or recommendations provided during the appointment have
                  been communicated.
                  <br>
                  After the appointment is completed, patients may be advised to follow any post-appointment
                  instructions
                  provided by the healthcare provider, such as taking medications as prescribed, scheduling follow-up
                  appointments, or monitoring symptoms.
                  <br>
                  Overall, the "completed" status marks the successful conclusion of the healthcare encounter, and
                  patients
                  can feel reassured that their needs have been addressed during the appointment.
               </ng-container>
            </ng-container>
         </ng-container>
      </div>
   </div>
   <div bottom>
      <div class="flex justify-end gap-x-1">
         <button
            data-te-modal-dismiss
            data-te-ripple-color="light"
            data-te-ripple-init
            type="button"
            class="btn btn-blue btn-shadow"
         > OK, I understand.
         </button>
      </div>
   </div>
</app-modal>
